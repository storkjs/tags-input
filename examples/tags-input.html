<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">

	<link rel="stylesheet" type="text/css" href="../dist/tags-input.min.css">
	<link rel="stylesheet" type="text/css" href="../dist/simple-theme.min.css">

	<script src="../bower_components/stork-shims/dist/shims.min.js"></script>
	<script src="../src/tags-input.js"></script>
	<script src="suggestions.js"></script>

	<style type="text/css">
		* {
			box-sizing: border-box;
		}

		html, body {
			height: 100%;
		}

		body, #parentOne, #parentTwo {
			display: flex;
			justify-content: center;
			align-items: flex-start;
			margin: 20px 0 0 0;
		}

		#parentOne {
			height: 95%;
			width: 60%;
			max-width: 600px;
			padding-top: 70px;
			display: flex;
			justify-content: center;
			align-items: center;
		}

		#parentTwo {
			display: flex;
			justify-content: center;
			align-items: flex-start;

			position: relative;
			height: 95%;
			width: 100%;
			padding-top: 50px;
			border-top: 1px solid #d0d0d0;
		}

		#destroyBtn, #removeAllBtn {
			position: absolute;
			top: -30px;
			left: 0;
		}

		#removeAllBtn {
			left: 90px;
		}

		/*#tagsInput {
			width: 100%;
			flex: 1;
			display: flex;
			max-height: 400px;
			overflow-y: auto;
		}*/
	</style>

	<script>
		var i, j, regex;
		var suggestions_handler = function suggestions_handler(text, chosenTags, callback) {
			text = text.trim();

			regex = new RegExp(text, 'gi');
			var ret = [];

			if (text.length > 0) { // perform search only on text
				for (i = 0; i < suggestionGroups.length; i++) {
					for (j = 0; j < suggestionGroups[i].items.length; j++) {
						if (suggestionGroups[i].items[j].label.match(regex)) {
							if (!ret.last || ret.last.field !== suggestionGroups[i].field) {
								ret.push({
									label: suggestionGroups[i].label,
									field: suggestionGroups[i].field,
									items: []
								});
							}
							ret.last.items.push({
								label: suggestionGroups[i].items[j].label,
								value: suggestionGroups[i].items[j].value
							});
						}
					}
				}

				callback(ret);
			}
			else {
				callback([
					{field: 'misc', label: '', items: [{label: 'no group label', value: 'no_group_label'}]},
					{field: '', label: '', items: [{label: 'no group at all', value: 'no_group'}]}
				]);
			}
		};

		var testTags;
		document.addEventListener("DOMContentLoaded", function (e) {
			testTags = new StorkTagsInput({
				element: document.getElementById('tagsInput'),
				suggestionsHandler: suggestions_handler,
				rechooseRemove: true,
				inputMinWidth: 70,
				placeholder: 'Search Something',
				persistentPlaceholder: true,
				multiline:true,
				maxlength: 60,
				maxTags: 300,
				persistentSuggestions: false
			});

			testTags.addTag({value: 'USD', label: 'US Dollar', groupField: 'currencies', groupLabel: 'Currencies'});
			testTags.addTag({value: 'EUR', groupField: 'currencies'});

			testTags.addEventListener('tag-added', function (e) {
				console.log('added tag:', e.detail);
			}, false);
			testTags.addEventListener('tag-removed', function (e) {
				console.log('removed tag:', e.detail);
			}, false);

			document.getElementById('destroyBtn').addEventListener('click', testTags.destroy.bind(testTags), false);
			document.getElementById('removeAllBtn').addEventListener('click', testTags.removeAllTags.bind(testTags), false);
		});
	</script>
</head>
<body>
<div id="parentOne">
	<div id="parentTwo">
		<button id="destroyBtn" type="button">Destroy</button>
		<button id="removeAllBtn" type="button">Clear All Tags</button>
		<div id="tagsInput"></div>
	</div>
</div>
</body>
</html>